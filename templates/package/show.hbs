{{#with package}}

{{> package-header this}}

<div class="content-column">

  <form class="star">
    <input type="hidden" name="name" value="{{name}}">
    <input id="star-input" type="checkbox" name="isStarred" value="true" {{#if isStarred}}checked{{/if}}>
    <label for="star-input" class="icon-star"></label>
    {{> form_security ..}}
  </form>

  <div id="readme" class="markdown" data-package="{{name}}">
    {{#if readme}}
      {{{readme}}}
    {{else}}
      <p>
        Sadly, this package has no readme.
        {{#if repository.url}}
          <a href="{{repository.url}}">Go write one!</a>
        {{/if}}
      </p>
    {{/if}}
  </div>

</div>

<div class="sidebar">

  {{#if installCommand}}
    <div class="autoselect-wrapper npm-install icon-download">
      <input type="text" value="{{installCommand}}" readonly>
    </div>
  {{/if}}

	<ul class="box">

    {{#if publisher}}
      <li class="last-publisher">
        <a href="/~{{publisher.name}}">
          <img src="{{publisher.avatar.medium}}" alt="{{publisher.name}}" />
          <span>{{publisher.name}}</span>
        </a>
        {{#if lastPublishedAt}}
          published
          <span data-date="{{lastPublishedAt}}" data-date-format="relative">
            {{lastPublishedAt}}
          </span>
        {{/if}}
      </li>
    {{/if}}

    <li>
      <strong>{{version}}</strong>
      is the latest
      {{#if singleVersion}}
        release
      {{else}}
        of {{versionsCount}} releases
      {{/if}}
    </li>

    {{#if repository.url}}
      <li>
        <a href="{{repository.url}}">{{schemeless repository.url}}</a>
      </li>
    {{/if}}

    {{#if homepage}}
      <li>
        <a href="{{homepage}}">{{schemeless homepage}}</a>
      </li>
    {{/if}}

    {{#if license}}
      <li>
        <a href="{{license.url}}">{{license.name}}</a> <span> license</span>
      </li>
    {{/if}}

  </ul>

  {{#if showMaintainers}}
    <h3>Maintainers</h3>
    <ul class="humans">
      {{#each maintainers}}
        <li>
          <a href="/~{{name}}" rel="tipsy" title="{{name}}">
            {{#if avatar.medium}}<img src="{{avatar.medium}}" alt="{{name}}">{{/if}}
          </a>
        </li>
      {{/each}}
    </ul>
  {{/if}}

  <h3>Stats</h3>
  <ul class="box stats">

    <!-- downloads will be ajaxed into this spot -->

    {{#if bugs.url}}
      <li id="issues" {{#if ghapi}}data-ghapi="{{ghapi}}"{{/if}}>
        <span class="original">Have an issue? <a href="{{bugs.url}}">File it.</a></span>
        {{#if ghapi}}
          <span class="enhanced" style="display:none">
            <a href="{{bugs.url}}"></a> on GitHub
          </span>
        {{/if}}
      </li>
    {{/if}}

    {{#if pull_requests.url}}
      <li id="pull_requests" style="display:none">
        <a href="{{pull_requests.url}}"></a> on GitHub
      </li>
    {{/if}}

  </ul>

  <h3>Keywords</h3>
  <p class="list-of-links">
    {{#if keywords}}
      {{#each keywords}}
        <a href="/browse/keyword/{{this}}">{{this}}</a>{{#unless @last}}, {{/unless}}
      {{/each}}
    {{else}}
      None
    {{/if}}
  </p>

  <h3>Dependencies {{#if dependencies}}({{dependencies.length}}){{/if}}</h3>
  <p class="list-of-links">
    {{#if dependencies}}
      {{#each dependencies}}
        {{#unless @last}}
          <a href="/package/{{this}}">{{this}}</a>,
        {{else}}
          {{#unless noHref}}
            <a href="/package/{{this}}">{{this}}</a>
          {{else}}
            <a>{{text}}</a>
          {{/unless}}
        {{/unless}}
      {{/each}}
    {{else}}
      None
    {{/if}}
  </p>

  {{#if dependents}}
    <h3><a href="/browse/depended/{{name}}">Dependents</a></h3>
    <p class="list-of-links">
      {{#each dependents}}
        {{#if @last}}
          <a href="{{url}}">{{name}}</a>.
        {{else}}
          {{#if url}}
            <a href="{{url}}">{{name}}</a>,
          {{else}}
            {{name}},
          {{/if}}
        {{/if}}
      {{/each}}
    </p>
  {{/if}}

  <script type="application/ld+json">
    {
      "@context": "http://schema.org",
      "@type": "SoftwareApplication",
      "name": "{{name}}",
      "description": "{{description}}",
      "url": "{{../canonicalURL}}",
      "keywords": "{{keywords}}",
      "applicationCategory": "DeveloperApplication",
      "offers": {
         "@type": "Offer",
         "price": "0.00"
      }
    }
  </script>

  <div class="hiring-container" data-template="sidebar"></div>

</div>

{{/with}}
